<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>NEOS | ì¶©ì „</title>
    <link rel="stylesheet" href="/css/fix/charge.css">
    <link rel="stylesheet" href="/css/fix/chatting.css">
    <link rel="stylesheet" href="/css/fix/loginHeader.css">
    <link rel="stylesheet" href="/css/fix/header.css">
    <link rel="stylesheet" href="/css/neosUser/modalList.css">
    <link rel="icon" type="image/x-icon" href="/images/fix/favicon.png">
</head>
<body>
<header th:replace="/app/fix/header.html :: header"></header>

<div id="next">
    <section class="payment">
        <div class="commonContentViewHeader"><h1><span class="smTxt">LET'S be rich</span>
            <span class="bgTxt">ë„¤ì˜¤ í¬ì¸íŠ¸ ì¶©ì „</span></h1></div>
        <div>
            <div class="adWrap"><p>ë” ë§ì€ ì„œë¹„ìŠ¤ë¥¼ ì¦ê¸°ê³  ì‹¶ë‚˜ìš”?</p>
                <span>ë„¤ì˜¤ìŠ¤ì™€ í•¨ê»˜ í•˜ëŠ”ê±´ ì–´ë–¨ê¹Œìš”?</span><span>(ì„œë¹„ìŠ¤ ì´ìš© í›„, ë„¤ì˜¤ë ¥ì´ ì§€ê¸‰ë©ë‹ˆë‹¤.)</span></div>
            <div class="step1 paymentStep"><p class="stepNumber"><span>1ë‹¨ê³„.</span>ê²°ì œ ê¸ˆì•¡ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
                <div class="chargeTable">
                    <table>
                        <thead>
                        <tr>
                            <th>ì„ íƒ</th>
                            <th>ê¸ˆì•¡</th>
                            <th>ìƒí’ˆ ìƒì„¸</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><label class="checkBox" ><input class = "inputRadio" type="radio" name="price" value="F01" ><span
                                    class="checkmark"></span></label></td>
                            <td>ì§ì ‘ ì…ë ¥</td>
                            <td><input class="cashCheck" id="name"  onkeyup="printName()" name = "point" type="text" placeholder="í¬ì¸íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ìˆ«ìë§Œ)" autocomplete="off" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1'); disabled" disabled="disabled" ></td>
                        </tr>
                        <tr>
                            <td><label class="checkBox"><input class = "radio" type="radio" name="price" value="5000" checked="" ><span
                                    class="checkmark"></span></label></td>
                            <td class="pr">5000ì›</td>
                            <td>5000 ë„¤ì˜¤í¬ì¸íŠ¸ + 500 ë„¤ì˜¤ë ¥</td>
                        </tr>
                        <tr>
                            <td><label  class="checkBox"><input class = "radio"type="radio" name="price" value="10000" ><span
                                    class="checkmark"></span></label></td>
                            <td class="pr">10000ì›</td>
                            <td>10000 ë„¤ì˜¤í¬ì¸íŠ¸ + 1,000 ë„¤ì˜¤ë ¥</td>
                        </tr>
                        <tr>
                            <td><label class="checkBox"><input class = "radio" type="radio" name="price" value="20000" ><span
                                    class="checkmark"></span></label></td>
                            <td class="pr">20000ì›</td>
                            <td>20000 ë„¤ì˜¤í¬ì¸íŠ¸ + 2,000 ë„¤ì˜¤ë ¥</td>
                        </tr>
                        <tr>
                            <td><label class="checkBox"><input class = "radio" type="radio" name="price" value="50000" ><span
                                    class="checkmark"></span></label></td>
                            <td class="pr">50000ì›</td>
                            <td>50000 ë„¤ì˜¤í¬ì¸íŠ¸ + 5,000ë„¤ì˜¤ë ¥</td>
                        </tr>
                        </tbody>
                    </table>
                    <div style="margin-top: 10px;">ì´ ê²°ì œê¸ˆì•¡ : <span class = "results" id="result">5000</span>ì›  </div>
                </div>
            </div>
            <div class="step2 paymentStep"><p class="stepNumber"><span>2ë‹¨ê³„.</span>ê²°ì œí•´ì£¼ì„¸ìš”.</p>

                <div class="easyPayment paymentMethod"><p>ê°„í¸ ê²°ì œ</p>
                    <div th:if="${session.loginUser}">
                        <button class="public" style="background-color: #1A7CFF; color: #fff; font-size: 18px; line-height: 18px; padding-top: 1px;">ğŸ’³ ì¼ë°˜ ê²°ì œ</button>
                        <button class="kakaoPay"></button>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div th:replace="/app/neosUser/modalList.html :: modalSpace"></div>
<div th:replace="/app/fix/chattingAll.html :: chattingAll"></div>
<div th:replace="/app/fix/footer.html :: footer"></div>
</body>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script src="/js/fix/login.js"></script>
<script src="/js/fix/chatting.js"></script>
<script>
    var $value = $("input[type=radio][name=price]:checked").val();
    var $input = $("input[type=text][name=point]:checked").val();
    var $result = $(".results");

    $(document).ready(function() {
        $('.radio').change(function() {
            var radio = $("input[type=radio][name=price]:checked").val();
            var input = $("input[type=text][name=point]:checked").val();
            if(radio == "10000"){
                $result.text("10000");
            }
            if(radio == "20000"){
                $result.text("20000");
            }
            if(radio == "50000"){
                $result.text("50000");
            }
            if(radio == "5000"){
                $result.text("5000");
            }
            if(input == input){
                $result.text(input);
            }
        })
    });

    function printName()  {
        const name = document.getElementById('name').value;
        document.getElementById("result").innerText = name;
    }


    $(document).ready(function() {
        if($(".radio").is(":checked")){
            $(".cashCheck").attr("disabled", true);
        };

        $(".radio").change(function(){
            if($(".radio").is(":checked")){
                $(".cashCheck").attr("disabled", true);
            };
        });
        $(".inputRadio").change(function(){
            if($(".inputRadio").is(":checked")){
                $(".cashCheck").attr("disabled", false);
            };
        });
    });


    function showPay() {
        $(".payModal").css("display", "block");
    }
    $(".closeBtn").on("click", function () {
        $(".payModal").css("display", "none");
    })
    $(".btn").on("click", function () {
        $(".payModal").css("display", "none");
    })

</script>
<script src="https://js.bootpay.co.kr/bootpay-4.2.6.min.js" type="application/javascript"></script>
<!--<script src="/js/fix/pay.js"></script>-->
<script>
    function pointSave(pay) {
        $.ajax({
            url: "/pay/chargingOk",
            type: "post",
            data: JSON.stringify(pay),
            contentType: "application/json; charset=utf-8",
            success: function() {
                showPay();
            },
            error: function (xhr, status, err) {
                console.log(xhr, status, err);
            }
        });
    }

    async function kakaoPay() {
        const response = await Bootpay.requestPayment({
            "application_id": "6396df69d01c7e001bfeb951",
            "price": $(".results").text(),
            "order_name": "NEOS",
            "order_id": 'order_id_' + new Date().getTime(),
            "pg": "ì¹´ì¹´ì˜¤í˜ì´",
            "method": "ì¹´ì¹´ì˜¤í˜ì´",
            "tax_free": 0,
            "user": {
                "id": $("#user").val()
            },
            "items": [
                {
                    "id": 'id_' + new Date().getTime(),
                    "name": "Neos Point",
                    "qty": 1,
                    "price": $(".results").text()
                }
            ],
            "extra": {
                "open_type": "iframe",
                "card_quota": "0,2,3",
                "seller_name": "NEOS",
                "escrow": false
            }
        })
        switch (response.event) {
            case 'done':
                // ê²°ì œ ì™„ë£Œ ì²˜ë¦¬
                pointSave({
                    neosPointMoney: response.data.price,
                    neosPointContent: "í¬ì¸íŠ¸ì¶©ì „",
                    userId: $('#userId').val()
                });
                break;
        }
    }


    async function publicPay() {
        const response = await Bootpay.requestPayment({
            "application_id": "6396df69d01c7e001bfeb951",
            "price": $(".results").text(),
            "order_name": "NEOS",
            "order_id": 'order_id_' + new Date().getTime(),
            "pg": "ì¼€ì´ì”¨í”¼",
            "method": "ì¹´ë“œ",
            "user": {
                "id": $("#user").val()
            },
            "items": [
                {
                    "id": 'id_' + new Date().getTime(),
                    "name": "Neos Point",
                    "qty": 1,
                    "price": $(".results").text()
                }
            ],
            "extra": {
                "open_type": "iframe",
                "card_quota": "0,2,3",
                "seller_name": "NEOS",
                "escrow": false
            }
        })
        switch (response.event) {
            case 'done':
                // ê²°ì œ ì™„ë£Œ ì²˜ë¦¬
                pointSave({
                    neosPointMoney: response.data.price,
                    neosPointContent: "í¬ì¸íŠ¸ì¶©ì „",
                    userId: $('#userId').val()
                });
                break;
        }
    }


    $(".kakaoPay").on("click", function () {
        kakaoPay();
    })

    $(".public").on("click", function () {
        publicPay();
    })
</script>
<script src="/js/fix/login.js"></script>
<script src="/js/fix/header.js"></script>
</html>